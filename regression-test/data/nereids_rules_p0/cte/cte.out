-- This file is automatically generated. You should know what you did if you want to edit this
-- !sql --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----PhysicalProject
------NestedLoopJoin[CROSS_JOIN]
--------PhysicalProject
----------filter((t1.__DORIS_DELETE_SIGN__ = 0))
------------PhysicalOlapScan[t1]
--------PhysicalDistribute[DistributionSpecReplicated]
----------PhysicalProject
------------filter((t1.__DORIS_DELETE_SIGN__ = 0))
--------------PhysicalOlapScan[t1]

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------filter((t1.__DORIS_DELETE_SIGN__ = 0))
--------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[CROSS_JOIN]
----------PhysicalDistribute[DistributionSpecExecutionAny]
------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------filter((t1.__DORIS_DELETE_SIGN__ = 0))
--------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[INNER_JOIN](cast(sum(col2) as DOUBLE) > (cast(0.05 as DOUBLE) * avg(col2)))
----------hashAgg[GLOBAL]
------------PhysicalDistribute[DistributionSpecHash]
--------------hashAgg[LOCAL]
----------------PhysicalDistribute[DistributionSpecExecutionAny]
------------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------PhysicalProject
--------------hashAgg[GLOBAL]
----------------PhysicalDistribute[DistributionSpecGather]
------------------hashAgg[LOCAL]
--------------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------------PhysicalProject
------------------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------filter((t1.__DORIS_DELETE_SIGN__ = 0))
--------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[CROSS_JOIN]
----------PhysicalDistribute[DistributionSpecExecutionAny]
------------filter((t1.col2 = 3))
--------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------filter((cast(col1 as DOUBLE) = 2.0))
--------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------filter((t1.__DORIS_DELETE_SIGN__ = 0) and col2 IN (3, 4))
--------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[CROSS_JOIN]
----------PhysicalDistribute[DistributionSpecExecutionAny]
------------filter((cte1.col2 = 3))
--------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------filter((cte1.col2 = 4))
--------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------filter((t1.__DORIS_DELETE_SIGN__ = 0))
--------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[INNER_JOIN](cast(sum(col2) as DOUBLE) > (cast(0.05 as DOUBLE) * avg(col2)))
----------hashAgg[GLOBAL]
------------PhysicalDistribute[DistributionSpecHash]
--------------hashAgg[LOCAL]
----------------PhysicalDistribute[DistributionSpecExecutionAny]
------------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------PhysicalProject
--------------hashAgg[GLOBAL]
----------------PhysicalDistribute[DistributionSpecGather]
------------------hashAgg[LOCAL]
--------------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------------PhysicalProject
------------------------filter((cte.col2 > 1))
--------------------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------filter((t1.__DORIS_DELETE_SIGN__ = 0))
--------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[INNER_JOIN](cast(sum(col2) as DOUBLE) > (cast(0.05 as DOUBLE) * avg(col4)))
----------hashAgg[GLOBAL]
------------PhysicalDistribute[DistributionSpecHash]
--------------hashAgg[LOCAL]
----------------PhysicalDistribute[DistributionSpecExecutionAny]
------------------PhysicalProject
--------------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------PhysicalProject
--------------hashAgg[GLOBAL]
----------------PhysicalDistribute[DistributionSpecGather]
------------------hashAgg[LOCAL]
--------------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------------PhysicalProject
------------------------filter((cte.col2 > 1))
--------------------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------filter((t1.__DORIS_DELETE_SIGN__ = 0))
--------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[CROSS_JOIN]
----------PhysicalDistribute[DistributionSpecExecutionAny]
------------PhysicalProject
--------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------PhysicalProject
--------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
LogicalCteAnchor[543] ( cteId=CTEId#0 )
|--LogicalCteProducer[527] ( cteId=CTEId#0 )
|  +--LogicalProject[525] ( distinct=false, projects=[col1#0, col2#1, col3#2, col4#3], excepts=[] )
|     +--LogicalFilter[523] ( predicates=(__DORIS_DELETE_SIGN__#4 = 0) )
|        +--LogicalOlapScan ( qualified=regression_test_nereids_rules_p0_cte.t1, indexName=t1, selectedIndexId=25396, preAgg=ON )
+--LogicalResultSink[541] ( outputExprs=[col1#26, col2#27, col3#28] )
   +--LogicalAggregate[539] ( groupByExpr=[col1#26, col2#27, col3#28], outputExpr=[col1#26, col2#27, col3#28], hasRepeat=false )
      +--LogicalUnion ( qualifier=ALL, outputs=[col1#26, col2#27, col3#28], regularChildrenOutputs=[[col1#44, col2#45, col3#46], [col1#47, col2#48, col3#49]], constantExprsList=[], hasPushedFilter=false )
         |--LogicalProject[530] ( distinct=false, projects=[cast(col1#29 as VARCHAR(65533)) AS `col1`#44, cast(col2#30 as BIGINT) AS `col2`#45, col3#31 AS `col3`#46], excepts=[] )
         |  +--LogicalCteConsumer[528] ( cteId=CTEId#0, relationId=RelationId#5, name=cte1 )
         +--LogicalProject[533] ( distinct=false, projects=[cast((col2#36 + 1) as VARCHAR(65533)) AS `col1`#47, (col3#37 + 2) AS `col2`#48, col4#38 AS `col3`#49], excepts=[] )
            +--LogicalCteConsumer[531] ( cteId=CTEId#0, relationId=RelationId#6, name=cte1 )

-- !sql --
PLAN FRAGMENT 0
  OUTPUT EXPRS:
    col1[#25]
    col2[#26]
    col3[#27]
    col4[#28]
  PARTITION: UNPARTITIONED

  HAS_COLO_PLAN_NODE: false

  VRESULT SINK
     MYSQL_PROTOCAL

  4:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 1

  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 04
    UNPARTITIONED

  3:VHASH JOIN(384)
  |  join op: INNER JOIN(BROADCAST)[]
  |  equal join conjunct: (col2[#19] = col2[#15])
  |  cardinality=1
  |  vec output tuple id: 7
  |  vIntermediate tuple ids: 6 
  |  hash output slot ids: 16 17 14 15 
  |  distribute expr lists: 
  |  distribute expr lists: 
  |  
  |----1:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: 
  |    
  2:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 2
  OUTPUT EXPRS:
    col1[#6]
    col2[#7]
    col3[#8]
    col4[#9]
  PARTITION: HASH_PARTITIONED: col1[#0]

  HAS_COLO_PLAN_NODE: false

  MultiCastDataSinks
  STREAM DATA SINK
    EXCHANGE ID: 01
    UNPARTITIONED
    CONJUNCTS: (col3[#8] = 2)
    PROJECTIONS: col1[#6], col2[#7], col3[#8], col4[#9]
    PROJECTION TUPLE: 2
  STREAM DATA SINK
    EXCHANGE ID: 02
    RANDOM
    PROJECTIONS: col2[#7]
    PROJECTION TUPLE: 4

  0:VOlapScanNode(358)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#4] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col1[#0], col2[#1], col3[#2], col4[#3]
     project output tuple id: 1

-- !sql --
PLAN FRAGMENT 0
  OUTPUT EXPRS:
    col1[#34]
    col2[#35]
    col3[#36]
    col4[#37]
  PARTITION: UNPARTITIONED

  HAS_COLO_PLAN_NODE: false

  VRESULT SINK
     MYSQL_PROTOCAL

  7:VEXCHANGE
     offset: 0
     distribute expr lists: col1[#34], col2[#35], col3[#36], col4[#37]

PLAN FRAGMENT 1

  PARTITION: HASH_PARTITIONED: col1[#30], col2[#31], col3[#32], col4[#33]

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 07
    UNPARTITIONED

  6:VAGGREGATE (merge finalize)(699)
  |  group by: col1[#30], col2[#31], col3[#32], col4[#33]
  |  cardinality=1
  |  distribute expr lists: col1[#30], col2[#31], col3[#32], col4[#33]
  |  
  5:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 2

  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 05
    HASH_PARTITIONED: col1[#30], col2[#31], col3[#32], col4[#33]

  4:VAGGREGATE (update serialize)(693)
  |  STREAMING
  |  group by: col1[#26], col2[#27], col3[#28], col4[#29]
  |  cardinality=1
  |  distribute expr lists: 
  |  
  3:VUNION(690)
  |  
  |----2:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: 
  |    
  1:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 3
  OUTPUT EXPRS:
    col1[#6]
    col2[#7]
    col3[#8]
    col4[#9]
  PARTITION: HASH_PARTITIONED: col1[#0]

  HAS_COLO_PLAN_NODE: false

  MultiCastDataSinks
  STREAM DATA SINK
    EXCHANGE ID: 01
    RANDOM
    PROJECTIONS: col1[#6], col2[#7], col3[#8], col4[#9]
    PROJECTION TUPLE: 2
  STREAM DATA SINK
    EXCHANGE ID: 02
    RANDOM
    PROJECTIONS: col1[#6], col2[#7], col3[#8], col4[#9]
    PROJECTION TUPLE: 4

  0:VOlapScanNode(664)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#4] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col1[#0], col2[#1], col3[#2], col4[#3]
     project output tuple id: 1

-- !sql --
PLAN FRAGMENT 0
  OUTPUT EXPRS:
    col1[#34]
    col2[#35]
    col3[#36]
    col4[#37]
  PARTITION: UNPARTITIONED

  HAS_COLO_PLAN_NODE: false

  VRESULT SINK
     MYSQL_PROTOCAL

  7:VEXCHANGE
     offset: 0
     distribute expr lists: col1[#34], col2[#35], col3[#36], col4[#37]

PLAN FRAGMENT 1

  PARTITION: HASH_PARTITIONED: col1[#30], col2[#31], col3[#32], col4[#33]

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 07
    UNPARTITIONED

  6:VAGGREGATE (merge finalize)(755)
  |  group by: col1[#30], col2[#31], col3[#32], col4[#33]
  |  cardinality=1
  |  distribute expr lists: col1[#30], col2[#31], col3[#32], col4[#33]
  |  
  5:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 2

  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 05
    HASH_PARTITIONED: col1[#30], col2[#31], col3[#32], col4[#33]

  4:VAGGREGATE (update serialize)(749)
  |  STREAMING
  |  group by: col1[#26], col2[#27], col3[#28], col4[#29]
  |  cardinality=1
  |  distribute expr lists: 
  |  
  3:VUNION(746)
  |  
  |----2:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: 
  |    
  1:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 3
  OUTPUT EXPRS:
    col1[#6]
    col2[#7]
    col3[#8]
    col4[#9]
  PARTITION: HASH_PARTITIONED: col1[#0]

  HAS_COLO_PLAN_NODE: false

  MultiCastDataSinks
  STREAM DATA SINK
    EXCHANGE ID: 01
    RANDOM
    PROJECTIONS: col1[#6], col2[#7], col3[#8], col4[#9]
    PROJECTION TUPLE: 2
  STREAM DATA SINK
    EXCHANGE ID: 02
    RANDOM
    PROJECTIONS: col1[#6], col2[#7], col3[#8], col4[#9]
    PROJECTION TUPLE: 4

  0:VOlapScanNode(720)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#4] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col1[#0], col2[#1], col3[#2], col4[#3]
     project output tuple id: 1

-- !sql --
PLAN FRAGMENT 0
  OUTPUT EXPRS:
    col1[#6]
    col2[#7]
    col3[#8]
    col4[#9]
  PARTITION: UNPARTITIONED

  HAS_COLO_PLAN_NODE: false

  VRESULT SINK
     MYSQL_PROTOCAL

  1:VEXCHANGE
     offset: 0
     distribute expr lists: col1[#6]

PLAN FRAGMENT 1

  PARTITION: HASH_PARTITIONED: col1[#0]

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 01
    UNPARTITIONED

  0:VOlapScanNode(137)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#4] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col1[#0], col2[#1], col3[#2], col4[#3]
     project output tuple id: 1

-- !sql --
PLAN FRAGMENT 0
  OUTPUT EXPRS:
    col1[#20]
    col2[#21]
    col3[#22]
    col4[#23]
  PARTITION: UNPARTITIONED

  HAS_COLO_PLAN_NODE: false

  VRESULT SINK
     MYSQL_PROTOCAL

  5:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 1

  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 05
    UNPARTITIONED

  4:VUNION(370)
  |  
  |----3:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: col1[#16]
  |    
  1:VEXCHANGE
     offset: 0
     distribute expr lists: col1[#6]

PLAN FRAGMENT 2

  PARTITION: HASH_PARTITIONED: col1[#10]

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 03
    RANDOM

  2:VOlapScanNode(358)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#14] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col1[#10], col2[#11], col3[#12], col4[#13]
     project output tuple id: 3

PLAN FRAGMENT 3

  PARTITION: HASH_PARTITIONED: col1[#0]

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 01
    RANDOM

  0:VOlapScanNode(348)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#4] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col1[#0], col2[#1], col3[#2], col4[#3]
     project output tuple id: 1

-- !sql --
PLAN FRAGMENT 0
  OUTPUT EXPRS:
    col1[#28]
    col2[#29]
    col3[#30]
    col4[#31]
  PARTITION: UNPARTITIONED

  HAS_COLO_PLAN_NODE: false

  VRESULT SINK
     MYSQL_PROTOCAL

  5:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 1
  OUTPUT EXPRS:
    col1[#20]
    col2[#21]
    col3[#22]
    col4[#23]
  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  MultiCastDataSinks
  STREAM DATA SINK
    EXCHANGE ID: 05
    UNPARTITIONED
    PROJECTIONS: col1[#20], col2[#21], col3[#22], col4[#23]
    PROJECTION TUPLE: 5

  4:VUNION(413)
  |  
  |----3:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: col1[#16]
  |    
  1:VEXCHANGE
     offset: 0
     distribute expr lists: col1[#6]

PLAN FRAGMENT 2

  PARTITION: HASH_PARTITIONED: col1[#10]

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 03
    RANDOM

  2:VOlapScanNode(401)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#14] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col1[#10], col2[#11], col3[#12], col4[#13]
     project output tuple id: 3

PLAN FRAGMENT 3

  PARTITION: HASH_PARTITIONED: col1[#0]

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 01
    RANDOM

  0:VOlapScanNode(391)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#4] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col1[#0], col2[#1], col3[#2], col4[#3]
     project output tuple id: 1

-- !sql --
PLAN FRAGMENT 0
  OUTPUT EXPRS:
    col1[#48]
    col2[#49]
    col3[#50]
    col4[#51]
  PARTITION: UNPARTITIONED

  HAS_COLO_PLAN_NODE: false

  VRESULT SINK
     MYSQL_PROTOCAL

  11:VEXCHANGE
     offset: 0
     distribute expr lists: col1[#48], col2[#49], col3[#50], col4[#51]

PLAN FRAGMENT 1

  PARTITION: HASH_PARTITIONED: col1[#44], col2[#45], col3[#46], col4[#47]

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  10:VAGGREGATE (merge finalize)(1045)
  |  group by: col1[#44], col2[#45], col3[#46], col4[#47]
  |  cardinality=1
  |  distribute expr lists: col1[#44], col2[#45], col3[#46], col4[#47]
  |  
  9:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 2

  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 09
    HASH_PARTITIONED: col1[#44], col2[#45], col3[#46], col4[#47]

  8:VAGGREGATE (update serialize)(1039)
  |  STREAMING
  |  group by: col1[#40], col2[#41], col3[#42], col4[#43]
  |  cardinality=1
  |  distribute expr lists: 
  |  
  7:VUNION(1036)
  |  
  |----6:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: 
  |    
  5:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 3
  OUTPUT EXPRS:
    col1[#20]
    col2[#21]
    col3[#22]
    col4[#23]
  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  MultiCastDataSinks
  STREAM DATA SINK
    EXCHANGE ID: 05
    RANDOM
    PROJECTIONS: col1[#20], col2[#21], col3[#22], col4[#23]
    PROJECTION TUPLE: 5
  STREAM DATA SINK
    EXCHANGE ID: 06
    RANDOM
    PROJECTIONS: col1[#20], col2[#21], col3[#22], col4[#23]
    PROJECTION TUPLE: 7

  4:VUNION(1016)
  |  
  |----3:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: col1[#16]
  |    
  1:VEXCHANGE
     offset: 0
     distribute expr lists: col1[#6]

PLAN FRAGMENT 4

  PARTITION: HASH_PARTITIONED: col1[#10]

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 03
    RANDOM

  2:VOlapScanNode(1004)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#14] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col1[#10], col2[#11], col3[#12], col4[#13]
     project output tuple id: 3

PLAN FRAGMENT 5

  PARTITION: HASH_PARTITIONED: col1[#0]

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 01
    RANDOM

  0:VOlapScanNode(994)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#4] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col1[#0], col2[#1], col3[#2], col4[#3]
     project output tuple id: 1

-- !sql --
PLAN FRAGMENT 0
  OUTPUT EXPRS:
    col1[#26]
    col2[#27]
    col3[#28]
    col4[#29]
  PARTITION: UNPARTITIONED

  HAS_COLO_PLAN_NODE: false

  VRESULT SINK
     MYSQL_PROTOCAL

  4:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 1

  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 04
    UNPARTITIONED

  3:VUNION(343)
  |  
  |----2:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: 
  |    
  1:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 2
  OUTPUT EXPRS:
    col1[#6]
    col2[#7]
    col3[#8]
    col4[#9]
  PARTITION: HASH_PARTITIONED: col1[#0]

  HAS_COLO_PLAN_NODE: false

  MultiCastDataSinks
  STREAM DATA SINK
    EXCHANGE ID: 01
    RANDOM
    CONJUNCTS: (col3[#8] < 5)
    PROJECTIONS: col1[#6], col2[#7], col3[#8], col4[#9]
    PROJECTION TUPLE: 2
  STREAM DATA SINK
    EXCHANGE ID: 02
    RANDOM
    CONJUNCTS: (col2[#7] > 1)
    PROJECTIONS: col1[#6], col2[#7], col3[#8], col4[#9]
    PROJECTION TUPLE: 4

  0:VOlapScanNode(311)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#4] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col1[#0], col2[#1], col3[#2], col4[#3]
     project output tuple id: 1

-- !sql --
PLAN FRAGMENT 0
  OUTPUT EXPRS:
    col2[#12]
  PARTITION: UNPARTITIONED

  HAS_COLO_PLAN_NODE: false

  VRESULT SINK
     MYSQL_PROTOCAL

  4:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 1

  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 04
    UNPARTITIONED

  3:VUNION(283)
  |  
  |----2:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: 
  |    
  1:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 2
  OUTPUT EXPRS:
    col2[#6]
    col3[#7]
  PARTITION: HASH_PARTITIONED: col1[#0]

  HAS_COLO_PLAN_NODE: false

  MultiCastDataSinks
  STREAM DATA SINK
    EXCHANGE ID: 01
    RANDOM
    PROJECTIONS: col2[#6]
    PROJECTION TUPLE: 2
  STREAM DATA SINK
    EXCHANGE ID: 02
    RANDOM
    PROJECTIONS: col3[#7]
    PROJECTION TUPLE: 4

  0:VOlapScanNode(257)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#4] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col2[#1], col3[#2]
     project output tuple id: 1

-- !sql --
PLAN FRAGMENT 0
  OUTPUT EXPRS:
    col3[#13]
  PARTITION: UNPARTITIONED

  HAS_COLO_PLAN_NODE: false

  VRESULT SINK
     MYSQL_PROTOCAL

  4:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 1

  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 04
    UNPARTITIONED

  3:VHASH JOIN(356)
  |  join op: INNER JOIN(BROADCAST)[]
  |  equal join conjunct: (col3[#10] = col3[#8])
  |  cardinality=1
  |  vec output tuple id: 7
  |  vIntermediate tuple ids: 6 
  |  hash output slot ids: 10 
  |  distribute expr lists: 
  |  distribute expr lists: 
  |  
  |----1:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: 
  |    
  2:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 2
  OUTPUT EXPRS:
    col3[#6]
  PARTITION: HASH_PARTITIONED: col1[#0]

  HAS_COLO_PLAN_NODE: false

  MultiCastDataSinks
  STREAM DATA SINK
    EXCHANGE ID: 01
    UNPARTITIONED
    PROJECTIONS: col3[#6]
    PROJECTION TUPLE: 2
  STREAM DATA SINK
    EXCHANGE ID: 02
    RANDOM
    PROJECTIONS: col3[#6]
    PROJECTION TUPLE: 4

  0:VOlapScanNode(330)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#4] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col3[#2]
     project output tuple id: 1

-- !sql --
PLAN FRAGMENT 0
  OUTPUT EXPRS:
    col2[#37]
    col1[#38]
  PARTITION: UNPARTITIONED

  HAS_COLO_PLAN_NODE: false

  VRESULT SINK
     MYSQL_PROTOCAL

  13:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 1

  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 13
    UNPARTITIONED

  12:VNESTED LOOP JOIN(919)
  |  join op: CROSS JOIN()
  |  is output left side only: false
  |  cardinality=0
  |  vec output tuple id: 21
  |  vIntermediate tuple ids: 20 
  |  distribute expr lists: 
  |  distribute expr lists: 
  |  
  |----10:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: 
  |    
  11:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 2
  OUTPUT EXPRS:
    col2[#26]
    col1[#27]
  PARTITION: UNPARTITIONED

  HAS_COLO_PLAN_NODE: false

  MultiCastDataSinks
  STREAM DATA SINK
    EXCHANGE ID: 10
    UNPARTITIONED
    PROJECTIONS: col2[#26]
    PROJECTION TUPLE: 16
  STREAM DATA SINK
    EXCHANGE ID: 11
    RANDOM
    PROJECTIONS: col2[#26], col1[#27]
    PROJECTION TUPLE: 18

  9:VNESTED LOOP JOIN(893)
  |  join op: INNER JOIN()
  |  join conjuncts: (CAST(col1[#25] AS DOUBLE) > CAST(sum(col2)[#23] AS DOUBLE))
  |  is output left side only: false
  |  cardinality=0
  |  vec output tuple id: 15
  |  vIntermediate tuple ids: 14 
  |  limit: 3
  |  distribute expr lists: 
  |  distribute expr lists: 
  |  
  |----2:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: 
  |    
  8:VAGGREGATE (merge finalize)(886)
  |  output: sum(partial_sum(col2)[#21])[#22]
  |  group by: 
  |  cardinality=1
  |  distribute expr lists: 
  |  
  7:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 3

  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  STREAM DATA SINK
    EXCHANGE ID: 07
    UNPARTITIONED

  6:VAGGREGATE (update serialize)(880)
  |  output: partial_sum(col2[#20])[#21]
  |  group by: 
  |  cardinality=1
  |  distribute expr lists: 
  |  
  5:VNESTED LOOP JOIN(874)
  |  join op: CROSS JOIN()
  |  is output left side only: false
  |  cardinality=1
  |  vec output tuple id: 11
  |  vIntermediate tuple ids: 10 
  |  distribute expr lists: 
  |  distribute expr lists: 
  |  
  |----3:VEXCHANGE
  |       offset: 0
  |       distribute expr lists: 
  |    
  4:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 4
  OUTPUT EXPRS:
    col2[#9]
  PARTITION: RANDOM

  HAS_COLO_PLAN_NODE: false

  MultiCastDataSinks
  STREAM DATA SINK
    EXCHANGE ID: 03
    UNPARTITIONED
    PROJECTIONS: col2[#9]
    PROJECTION TUPLE: 6
  STREAM DATA SINK
    EXCHANGE ID: 04
    RANDOM
    PROJECTIONS: col2[#9]
    PROJECTION TUPLE: 8

  1:VEXCHANGE
     offset: 0
     distribute expr lists: 

PLAN FRAGMENT 5
  OUTPUT EXPRS:
    col2[#6]
    col1[#7]
  PARTITION: HASH_PARTITIONED: col1[#0]

  HAS_COLO_PLAN_NODE: false

  MultiCastDataSinks
  STREAM DATA SINK
    EXCHANGE ID: 01
    RANDOM
    PROJECTIONS: col2[#6]
    PROJECTION TUPLE: 2
  STREAM DATA SINK
    EXCHANGE ID: 02
    UNPARTITIONED
    PROJECTIONS: col2[#6], col1[#7]
    PROJECTION TUPLE: 4

  0:VOlapScanNode(838)
     TABLE: regression_test_nereids_rules_p0_cte.t1(t1), PREAGGREGATION: ON
     PREDICATES: (__DORIS_DELETE_SIGN__[#4] = 0)
     partitions=1/1 (t1), tablets=3/3, tabletList=25397,25399,25401
     cardinality=0, avgRowSize=0.0, numNodes=1
     pushAggOp=NONE
     projections: col2[#1], col1[#0]
     project output tuple id: 1

